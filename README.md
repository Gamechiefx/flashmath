# FlashMath Arena âš¡

<div align="center">

**Master Math at the Speed of Light**

[![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/e.hill/FlashMath/releases)
[![Next.js](https://img.shields.io/badge/Next.js-16-black.svg)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue.svg)](https://www.typescriptlang.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

*A competitive math training platform where mental math becomes an esport.*

[Play Now](https://flashmath.io) Â· [Documentation](docs/) Â· [Report Bug](https://gitcode.lanit.services/e.hill/FlashMath/issues)

</div>

---

## What is FlashMath?

FlashMath transforms mental math practice from tedious drills into an addictive competitive experience. Built with a cyberpunk aesthetic and esports-inspired progression systems, it's designed for students, educators, and anyone who wants to sharpen their arithmetic skills.

### The Problem We Solve

Traditional math practice is boring. Worksheets don't motivate. Apps gamify wrongâ€”they reward time spent, not skill gained. Students plateau because there's no real challenge.

### Our Solution

FlashMath creates **real stakes** through:
- **Live 1v1 duels** where you race opponents in real-time
- **Team battles (2v2 to 5v5)** with strategic roles and relay mechanics
- **ELO-based matchmaking** so every match is competitive
- **100-tier progression** that genuinely increases difficulty
- **Weekly leagues** with promotion, relegation, and rewards

---

## Core Features

### âš”ï¸ Arena: Real-Time Competitive Matches

<details>
<summary><strong>1v1 Duels</strong> â€” Head-to-head mental math combat</summary>

- **ELO Matchmaking**: Face opponents at your skill level (Â±200 ELO range)
- **Operation Selection**: Choose Addition, Subtraction, Multiplication, or Division
- **Tier-Appropriate Questions**: Problems scale to your practice tier
- **AI Opponents**: Instant matches when no humans available (15-second fallback)
- **Win Streaks**: Build momentum with consecutive victories

</details>

<details>
<summary><strong>Team Battles (2v2 to 5v5)</strong> â€” Coordinated team competition</summary>

- **Party System**: Queue with friends in pre-made teams
- **Role Selection**: Choose your position (IGL, Anchor, Support)
- **Relay Rounds**: Pass the batonâ€”each player answers in sequence
- **First-to-Finish Bonuses**: +50 points for completing rounds first
- **Team Streaks**: Build 10/25/50/75 consecutive correct answers for bonus points
- **Tactical Breaks**: Halftime strategy sessions between rounds

</details>

<details>
<summary><strong>Competitive Ranks</strong> â€” Climb the ladder</summary>

| Rank | Division | Description |
|------|----------|-------------|
| Bronze | I, II, III | Foundation tier players |
| Silver | I, II, III | Building consistency |
| Gold | I, II, III | Solid fundamentals |
| Platinum | I, II, III | Advanced operations |
| Diamond | I, II, III | Expert-level speed |
| Master | I, II, III | Top 1% of players |

*Ranks unlock based on practice tier + arena wins*

</details>

---

### ğŸ“ˆ 100-Tier Progression System

Unlike simple "levels," FlashMath uses a **100-tier mastery system** organized into 5 bands:

| Band | Tiers | Difficulty | Examples |
|------|-------|------------|----------|
| **Foundation** | 1-20 | Basic facts | 7 Ã— 8, 15 - 9 |
| **Intermediate** | 21-40 | Extended facts | 24 Ã— 6, ? + 17 = 45 |
| **Advanced** | 41-60 | Multi-digit | 47 Ã— 23, 156 Ã· 12 |
| **Expert** | 61-80 | Complex operations | 234 Ã— 56, word problems |
| **Master** | 81-100 | Competition-level | Speed mastery, 3-digit ops |

**How Progression Works:**
- Earn **skill points** for correct answers (+1) and lose them for errors (-1)
- Accumulate **100 points** to advance a tier
- Fall below **0 points** and drop a tier
- Each operation (add/subtract/multiply/divide) tracks separately

---

### ğŸ† League System

Weekly competitive leagues with **promotion and relegation**:

| League | Color | Promotion | Demotion |
|--------|-------|-----------|----------|
| **Apex** | Purple | â€” | Bottom 2 + <20 XP |
| **Void** | Black | Top 3 | Bottom 2 + <20 XP |
| **Plasma** | Cyan | Top 3 | Bottom 2 + <20 XP |
| **Cobalt** | Blue | Top 3 | Bottom 2 + <20 XP |
| **Neon** | Green | Top 3 | â€” |

- **Weekly Reset**: Every 7 days, positions reset
- **XP Leaderboard**: Earn XP from practice and arena
- **Prizes**: Top 3 earn 250 Flux Coins
- **Ghost Players**: AI competitors keep leagues active

---

### ğŸ® Gamification

<details>
<summary><strong>Currency & Economy</strong></summary>

- **Flux Coins (Â§)**: Earned from practice, achievements, and league rewards
- **Starting Balance**: 100 Â§ for new players
- **Shop Rotation**: Items cycle through availability
- **Rarity Tiers**: Common â†’ Uncommon â†’ Rare â†’ Epic â†’ Legendary

</details>

<details>
<summary><strong>XP & Leveling</strong></summary>

- **Practice XP**: 1-5 XP per correct answer (speed-dependent)
- **Arena XP**: Based on match performance
- **Pilot Level**: Lifetime progression indicator
- **Level Rewards**: Coins and titles at milestones

</details>

<details>
<summary><strong>Achievements</strong></summary>

50+ achievements across categories:
- **Level Milestones**: Rising Star (Lv5), Elite Pilot (Lv75), Centurion (Lv100)
- **Mastery**: First Tier IV, Operation Specialist, Speed Demon
- **Arena**: First Blood, Win Streak 10, Diamond Rank
- **Wealth**: First Purchase, Big Spender, Collector
- **Social**: Email Verified, First Friend, Party Leader

*Each achievement unlocks coins and/or exclusive titles*

</details>

---

### ğŸ›ï¸ Cosmetic Shop & Locker

Customize your FlashMath experience with 8 cosmetic categories:

| Category | Description | Examples |
|----------|-------------|----------|
| **Themes** | UI color schemes | Synthwave, Matrix, Deep Space |
| **Particles** | Answer effects | Sparks, Glitch, Binary Rain |
| **Fonts** | Text styles | Neon Script, Terminal, Handwritten |
| **Sounds** | Answer feedback | 8-Bit, Typewriter, Futuristic |
| **BGM** | Background music | Techno, Ambient, Retro |
| **Titles** | Display names | "The Calculator", "Speed Demon" |
| **Frames** | Profile borders | Diamond Edge, Fire Ring |
| **Banners** | Profile backgrounds | Gradient waves, Geometric patterns |

**Rarity Pricing:**
- Common: 100-500 Â§
- Uncommon: 500-1,000 Â§
- Rare: 2,000-5,000 Â§
- Epic: 10,000-25,000 Â§
- Legendary: 35,000-50,000 Â§

---

### ğŸ¤ Social Features

<details>
<summary><strong>Friends System</strong></summary>

- **Friend Requests**: Send/accept/decline
- **Online Status**: See who's available
- **Quick Invite**: Party up with one click
- **Profile Cards**: View friend's stats, rank, and loadout

</details>

<details>
<summary><strong>Party System</strong></summary>

- **Create Parties**: Up to 5 players
- **Party Chat**: Coordinate before queuing
- **Sync Queue**: Entire party enters matchmaking together
- **Party Leader**: Controls queue settings

</details>

---

### ğŸ§  AI-Powered Practice

<details>
<summary><strong>Adaptive Learning Engine</strong></summary>

FlashMath uses an AI orchestrator to optimize your practice:

- **Dynamic Difficulty**: Questions adjust to your current tier
- **Weakness Detection**: Identifies operations that need work
- **Speed Thresholds**: 
  - âš¡ Lightning (â‰¤2s): +5 XP
  - âœ“ Accurate (â‰¤6s): +3 XP
  - ğŸ¢ Got It (>6s): +1 XP
- **Hint System**: AI-generated hints for struggling players (Claude-powered)
- **Session Analytics**: Post-practice breakdown of performance

</details>

---

### ğŸ“Š Analytics Dashboard

Professional-grade performance tracking:

- **Real-Time Stats**: Accuracy %, Average Speed, Current Streak
- **Tier Progress**: Visual mastery bars for each operation
- **Trend Analysis**: 10-session performance graphs
- **Weakest Link**: Auto-detected problem areas
- **Career Stats**: Lifetime problems solved, accuracy trends
- **Session History**: Review past practice sessions

---

## Technical Architecture

### Stack

| Layer | Technology |
|-------|------------|
| **Framework** | Next.js 16 (App Router) |
| **Language** | TypeScript 5.0 |
| **Styling** | Tailwind CSS 4.0 |
| **Animations** | Framer Motion |
| **Real-Time** | Socket.io |
| **Auth** | NextAuth v5 (Credentials + Google OAuth) |
| **Primary DB** | SQLite (users, inventory, progress) |
| **Arena DB** | PostgreSQL (match history, ELO) |
| **Cache/Queue** | Redis (matchmaking, presence, parties) |

### Infrastructure

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Nginx       â”‚
                    â”‚   (SSL/TLS)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                             â”‚
        â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
        â”‚  Next.js  â”‚                â”‚  Socket.io  â”‚
        â”‚   (API)   â”‚                â”‚  (WebSocket)â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚         â”‚         â”‚                   â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚SQLite â”‚ â”‚Postgresâ”‚ â”‚ Redis â”‚         â”‚Redis Pub/Subâ”‚
â”‚(Users)â”‚ â”‚(Arena) â”‚ â”‚(Queue)â”‚         â”‚ (Real-time) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Design Decisions

- **Hybrid Database**: SQLite for user data (zero-latency local queries) + PostgreSQL for arena matches (ACID compliance, horizontal scaling)
- **Redis Adapter**: Socket.io uses Redis pub/sub for multi-instance WebSocket scaling
- **Server Actions**: All business logic in `'use server'` actions for type-safe RPC
- **ELO per Operation**: Separate ratings for add/subtract/multiply/divide per game mode

---

## Getting Started

### Prerequisites

- Node.js 20+
- npm or pnpm
- Redis (for matchmaking/presence)
- PostgreSQL (for arena matches)

### Development Setup

```bash
# Clone the repository
git clone https://gitcode.lanit.services/e.hill/FlashMath.git
cd FlashMath

# Install dependencies
npm install

# Copy environment template
cp .env.example .env

# Edit .env with your values (see .env.example for required vars)

# Seed the database
npm run seed

# Start development server (includes Socket.io)
npm run dev:server

# Open http://localhost:3000
```

### Docker Development

```bash
# Start all services (app, nginx, postgres, redis)
docker-compose -f docker-compose.dev.yml up -d

# View logs
docker-compose -f docker-compose.dev.yml logs -f flashmath-dev

# Access at https://dev.flashmath.io:3443
```

### Production Deployment

```bash
# Build and deploy with Docker
docker-compose up -d

# Or use the CI/CD pipeline (pushes to main auto-deploy)
git push origin main
```

---

## Security Features

- **Password Hashing**: bcrypt with salt rounds
- **Session Management**: Secure HTTP-only cookies
- **2FA Support**: TOTP-based two-factor authentication
- **Rate Limiting**: Nginx-level request throttling
- **RBAC**: Role-based access (user, moderator, admin, super_admin)
- **Ban System**: Temporary and permanent account suspensions
- **Email Verification**: Required for arena access
- **Age Verification**: 13+ requirement for competitive play

---

## Admin Features

Access `/admin` (restricted to admin roles):

- **User Management**: Search, ban, unban, role assignment
- **System Controls**: Maintenance mode, signup toggle
- **Shop Management**: Edit item prices, add new cosmetics
- **Analytics**: Server-wide statistics
- **Match Auditing**: Review arena match history

---

## Contributing

We welcome contributions! Please follow these steps:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Development Guidelines

- Follow existing code style (ESLint + Prettier)
- Write TypeScript with strict types
- Add tests for new features
- Update documentation as needed

---

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## Acknowledgments

- Built with [Next.js](https://nextjs.org/)
- Real-time powered by [Socket.io](https://socket.io/)
- Authentication by [NextAuth.js](https://next-auth.js.org/)
- Icons from [Lucide](https://lucide.dev/)

---

<div align="center">

**Built with âš¡ by the FlashMath Team**

*Let's do some math!* ğŸ§®

</div>
